<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/tokyo-night-dark.min.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@3.3.3/dist/tailwind.min.css">
    <script src="./js/highlight.min.js"></script>
    <title>Build Dot C</title>
</head>

<body>
    <script>
        async function fetchData() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/MitchNine/build_dot_c/refs/heads/master/build.c');
                if (!response.ok) throw new Error('Network response was not ok');
                const data = await response.text();
                if (window.hljs && hljs.highlight) {
                    // highlight.js modern API: highlight(code, {language}) returns an object
                    const highlighted = hljs.highlight(data, { language: 'c' });
                    document.getElementById('build_dot_c').innerHTML = highlighted.value;
                } else {
                    // fallback: show raw text
                    document.getElementById('build_dot_c').innerText = data;
                }
            } catch (err) {
                document.getElementById('build_dot_c').innerText = '// Unable to load remote file: ' + err.message;
                console.error(err);
            }
        }
        
        async function downloadRemote(url, filename) {
            try {
                const res = await fetch(url);
                if (!res.ok) throw new Error('Network response was not ok');
                const blob = await res.blob();
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = filename || '';
                document.body.appendChild(link);
                link.click();
                URL.revokeObjectURL(link.href);
                document.body.removeChild(link);
            } catch (err) {
                console.error('Download failed, opening in new tab', err);
                window.open(url, '_blank');
            }
        }
        fetchData();
    </script>

    <style>
        :root{
            --bg:#0f1117;
            --card:#0f1724;
            --muted:#98a0c0;
            --accent:#7aa2f7;
            --accent-2:#9ece6a;
            --scroll-track: rgba(255,255,255,0.02);
            --scroll-thumb: rgba(255,255,255,0.06);
            --scroll-thumb-hover: rgba(255,255,255,0.10);
        }

        html,body{
            height:100%;
            margin:0;
            font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
            background: linear-gradient(180deg,#0f1117 0%, #141620 60%);
            color: #e6eef6;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
        }

        .container{
            max-width:1000px;
            margin:36px auto;
            padding:20px;
        }

        .title-card{
            background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border: 1px solid rgba(255,255,255,0.03);
            padding:20px 24px;
            border-radius:12px;
            display:flex;
            align-items:center;
            gap:16px;
            box-shadow: 0 6px 20px rgba(2,6,23,0.6);
        }

        .title-card h1{
            margin:0;
            font-size:1.6rem;
            letter-spacing:0.6px;
            color:var(--accent-2);
        }

        .title-card p{ margin:0; color:var(--muted); font-size:0.95rem }

        .controls{ display:flex; gap:8px; margin-left:auto }

        .button_box{
            display: flex;
            margin:12px 0 8px 0;
            gap:8px;
            justify-content:flex-end;
        }

        button{
            display:inline-flex;
            align-items:center;
            gap:8px;
            padding:8px 10px;
            background: linear-gradient(180deg,#394263,#2a3044);
            color: #f6f8ff;
            border: 1px solid rgba(255,255,255,0.04);
            border-radius:8px;
            cursor:pointer;
            transition: transform .06s ease, background .08s ease;
            font-weight:600;
            font-size:0.95rem;
        }

        button:hover{ transform:translateY(-2px); }

        button:active{ transform:translateY(0); }

        button svg{ display:block }

        .code_block{
            background-color: var(--card);
            color: #d8e2ff;
            margin: 8px auto 200px auto;
            padding: 12px;
            overflow: auto;
            scrollbar-width: thin;
            max-width: 100%;
            border-radius: 10px;
            z-index: 1;
            box-shadow: 0 8px 30px rgba(2,6,23,0.6);
            border: 1px solid rgba(255,255,255,0.03);
        }

        pre{ margin:0; font-family: 'Fira Code', ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', monospace; font-size:0.95rem; line-height:1.45; }

        .code_block pre{ max-height:60vh; white-space:pre; }

        .tooltip{ font-size:0.8rem; color:var(--muted) }

        a.download-link{ color:inherit; text-decoration:none; display:inline-flex; align-items:center; gap:8px }

        /* Custom scrollbars - WebKit based browsers */
        ::-webkit-scrollbar{ width:12px; height:12px }
        ::-webkit-scrollbar-track{ background: transparent }
        ::-webkit-scrollbar-thumb{
            background: linear-gradient(180deg, rgba(122,162,247,0.14), rgba(158,206,106,0.06));
            border-radius:10px;
            border: 3px solid transparent;
            background-clip: content-box;
        }
        ::-webkit-scrollbar-thumb:hover{
            background: linear-gradient(180deg, rgba(122,162,247,0.22), rgba(158,206,106,0.12));
        }

        /* Make the code block scrollbar a bit more visible */
        .code_block::-webkit-scrollbar{ width:12px; }
        .code_block::-webkit-scrollbar-track{ background: rgba(255,255,255,0.015); border-radius:10px }
        .code_block::-webkit-scrollbar-thumb{
            background: linear-gradient(180deg, rgba(122,162,247,0.20), rgba(158,206,106,0.08));
            border-radius:10px; border:3px solid transparent; background-clip: content-box;
        }
        .code_block::-webkit-scrollbar-thumb:hover{ background: linear-gradient(180deg, rgba(122,162,247,0.32), rgba(158,206,106,0.16)); }

        /* Firefox scrollbar styling */
        .code_block{ scrollbar-width: thin; scrollbar-color: rgba(122,162,247,0.20) rgba(255,255,255,0.015); }
        html{ scrollbar-width: thin; scrollbar-color: var(--scroll-thumb) transparent; }

        @media (max-width:640px){
            .title-card{ flex-direction:column; align-items:flex-start }
            .controls{ width:100%; justify-content:space-between }
        }
    </style>
    <div class="container">
        <div class="title-card">
            <div>
                <h1>Build.c</h1>
                <p class="tooltip">A tiny single-file build script for C/C++ projects â€” view or download the source below.</p>
            </div>
            <div class="controls">
                <div class="button_box">
                    <button type="button" class="download-btn" aria-label="Download build.c" onclick="downloadRemote('https://raw.githubusercontent.com/MitchNine/build_dot_c/refs/heads/master/build.c','build.c')">
                        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <path d="M12 15V3"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <div class="code_block">
            <pre><code id="build_dot_c" class="hljs"></code></pre>
        </div>
    </div>

</body>

</html>
